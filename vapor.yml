id: 27445
name: oli-chartiy-api
environments:
  development:
    domain:
      - api.olicharity.org
    database: oli-charity
    octane: true
    octane-database-session-persist: true
    octane-database-session-ttl: 10
    scheduler: true
    memory: 512
    cli-memory: 512
    runtime: 'php-8.1:al2'
    queue-timeout: 300
    timeout: 300
    build:
      - 'COMPOSER_MIRROR_PATH_REPOS=1 composer install --optimize-autoloader'
      - 'php artisan event:cache'
      - 'npm ci && npm run dev && rm -rf node_modules'
    deploy:
      - 'php artisan migrate --force'
  staging:
    domain:
      - dev-api.olicharity.org
      - api.imagine2080.com.au
    database: oli-charity
    octane: true
    octane-database-session-persist: true
    octane-database-session-ttl: 10
    scheduler: true
    memory: 1024
    cli-memory: 1024
    runtime: 'php-8.1:al2'
    queue-timeout: 300
    timeout: 300
    build:
      - 'COMPOSER_MIRROR_PATH_REPOS=1 composer install --optimize-autoloader'
      - 'php artisan event:cache'
      - 'npm ci && npm run dev && rm -rf node_modules'
    deploy:
      - 'php artisan migrate --force'
  test:
    database: oli-charity
    memory: 1024
    cli-memory: 512
    runtime: docker
    build:
      - 'COMPOSER_MIRROR_PATH_REPOS=1 composer install --optimize-autoloader'
      - 'php artisan event:cache'
      - 'npm ci && npm run dev && rm -rf node_modules'
